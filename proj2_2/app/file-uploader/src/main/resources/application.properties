# =========================================================
# APPLICATION
# =========================================================
spring.application.name=file-uploader

# =========================================================
# SERVER
# =========================================================
server.port=${SERVER_PORT:8080}
server.shutdown=graceful

# =========================================================
# REACTIVE R2DBC (PostgreSQL)
# =========================================================
spring.r2dbc.url=${SPRING_R2DBC_URL:r2dbc:postgresql://localhost:5432/filedb}
spring.r2dbc.username=${SPRING_R2DBC_USERNAME:postgres}
spring.r2dbc.password=${SPRING_R2DBC_PASSWORD:postgres}

# Disable blocking JDBC (мы полностью reactive)
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration

# R2DBC Pool (важно для production)
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=5
spring.r2dbc.pool.max-size=20
spring.r2dbc.pool.max-idle-time=30m
spring.r2dbc.pool.validation-query=SELECT 1

# =========================================================
# THYMELEAF (Reactive)
# =========================================================
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML

# =========================================================
# LOGGING
# =========================================================
logging.level.root=${LOG_LEVEL:INFO}
logging.level.org.springframework.r2dbc=INFO
logging.level.io.r2dbc.postgresql=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} %-5level %logger - %msg%n

# =========================================================
# ACTUATOR
# =========================================================
management.endpoints.web.exposure.include=${MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE:health,info}
management.endpoint.health.show-details=always
management.health.r2dbc.enabled=true

# =========================================================
# DEVTOOLS (Hot Reload)
# =========================================================
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=false

# =========================================================
# REACTIVE SERVER (NETTY)
# =========================================================
spring.codec.max-in-memory-size=10MB

# =========================================================
# FILE UPLOAD (на будущее)
# =========================================================
spring.webflux.multipart.max-in-memory-size=10MB
spring.webflux.multipart.max-parts=50
